<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta http-equiv="X-UA-Compatible" content="ie=edge" />
	<title>Systaurant</title>
	<link rel="stylesheet" href="/css/bootstrap.min.css" />
	<style type="text/css">
		.disabled {
			cursor: default;
		}
	</style>
</head>

<body>
	<nav class="navbar navbar-expand-md navbar-dark bg-dark">
		<a class="navbar-brand" id="index">Systaurant</a>

		<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
			<span class="navbar-toggler-icon"></span>
		</button>

		<div class="collapse navbar-collapse" id="collapsibleNavbar">
			<ul class="navbar-nav">
				<li class="nav-item">
					<a class="nav-link" id='menu'></a>
				</li>
				<li class="nav-item">
					<a class="nav-link" id='reserve'></a>
				</li>
				<li class="nav-item">
					<a class="nav-link" id='order'></a>
				</li>
				<li class="nav-item">
					<a class="nav-link" id='receipt'></a>
				</li>
				<li class="nav-item">
					<a class="nav-link" id='cooking'></a>
				</li>
				<li class="nav-item">
					<a class="nav-link" id='waiting'></a>
				</li>
				<li class="nav-item">
					<a class="nav-link" id='admin'></a>
				</li>
			</ul>
			<ul class="navbar-nav ml-auto">
				<li class="nav-item">
					<a class="nav-link" id='seat'></a>
				</li>
				<li class="nav-item">
					<a class="nav-link" id='login'></a>
				</li>
			</ul>
		</div>
	</nav>
	<div class="container">
		<div class="row">
			<div class="col">
				<h1 class="text-center pt-5">Systaurant</h1>
			</div>
		</div>
	</div>
	</div>
	<script src="/js/jquery-3.3.1.min.js"></script>
	<script src="/js/bootstrap.min.js"></script>
	<script src="/js/axios.min.js"></script>
	<script type="text/javascript">

		function load() {
			axios
				.post('/api/status')
				.then(res => {
					const stat = res.data;

					$("#index").attr("href", "/").text('Systaurant');
					$("#menu").attr("href", "/menu").text('Menu');

					if (!stat.employee && !stat.manager) {
						if (stat.table) {
							$("#seat").attr("href", "/logout/table").text("Remove table");
						} else {
							$("#seat").attr("href", "/login/table").text("Choose table");
						}
					} else {
						$("#seat").addClass('d-none');
					}

					if (stat.employee || stat.member) {
						$("#login").attr("href", "/logout").text("Logout");
					} else {
						$("#login").attr("href", "/login").text("Login");
					}

					if (stat.table) {
						$("#order").attr("href", "/order").text('Order');
					} else {
						$("#order").addClass('d-none');
					}
					
					if (stat.table) {
						$("#receipt").text('Receipt');
						if (stat.receipt) {
							$("#receipt").attr("href", "/receipt");
						} else {
							$("#receipt").addClass('disabled');
						}
					} else {
						$("#receipt").addClass('d-none');
					}
						

					if (stat.member) {
						$("#reserve").attr("href", "/reserve").text('Reserve');
					} else {
						$("#reserve").addClass('d-none');
					}

					if (stat.employee) {
						$("#cooking").attr("href", "/order/cooklist").text('Cooking List');
						$("#waiting").attr("href", "/order/waitlist").text('Waiting List');
					} else {
						$("#cooking").addClass('d-none');
						$("#waiting").addClass('d-none');
					}

					if (stat.manager) {
						$("#admin").attr("href", "/admin").text('Admin');
					} else {
						$("#admin").addClass('d-none');
					}

					console.log(stat);
				}).catch(res => {
					console.log(res);
				});
		}

		$(document).ready(load);

	</script>
</body>

</html>
